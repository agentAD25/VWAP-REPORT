<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VWAP Performance Dashboard - ALPHA DRIP</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1419 100%);
            color: #ffffff;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 100, 200, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(0, 150, 255, 0.3);
        }

        .header h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #00b4d8 0%, #0077b6 50%, #90e0ef 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 180, 216, 0.5);
        }

        .header .subtitle {
            color: #90e0ef;
            font-size: 1.1em;
        }

        .dashboard-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: rgba(15, 20, 35, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 150, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .chart-title {
            font-size: 1.3em;
            margin-bottom: 20px;
            color: #90e0ef;
            text-align: center;
            font-weight: 600;
        }

        .chart-subtitle {
            font-size: 0.9em;
            color: #7dd3fc;
            text-align: center;
            margin-bottom: 15px;
        }

        .insights-table {
            background: rgba(15, 20, 35, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 150, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .insights-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #90e0ef;
            text-align: center;
            font-weight: 600;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th {
            background: linear-gradient(135deg, #0077b6 0%, #00b4d8 100%);
            color: #ffffff;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            border: 1px solid rgba(0, 180, 216, 0.3);
        }

        td {
            padding: 12px 15px;
            border: 1px solid rgba(0, 150, 255, 0.2);
            color: #e0f7fa;
        }

        tr:nth-child(even) {
            background: rgba(0, 100, 200, 0.1);
        }

        tr:hover {
            background: rgba(0, 150, 255, 0.2);
            transition: background 0.3s;
        }

        .custom-settings {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 50, 100, 0.3);
            border-radius: 8px;
            border: 1px solid rgba(0, 150, 255, 0.2);
        }

        .custom-settings label {
            color: #90e0ef;
            font-size: 0.9em;
        }

        .custom-settings input {
            background: rgba(15, 20, 35, 0.8);
            border: 1px solid rgba(0, 150, 255, 0.3);
            color: #ffffff;
            padding: 8px 12px;
            border-radius: 5px;
            margin-left: 10px;
        }

        .positive {
            color: #4ade80;
        }

        .negative {
            color: #f87171;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #90e0ef;
        }

        .date-range-info {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 100, 200, 0.15);
            border-radius: 10px;
            border: 1px solid rgba(0, 150, 255, 0.3);
        }

        .date-range-info .label {
            color: #90e0ef;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .date-range-info .dates {
            color: #ffffff;
            font-size: 1.1em;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>VWAP Performance Dashboard</h1>
        <div class="subtitle">MGC | RTH | Crosses Only | Built by TonySnow | ALPHA DRIP</div>
    </div>

    <div class="dashboard-container">
        <div class="chart-container">
            <div class="chart-title">VWAP Performance - by Extension (Ticks)</div>
            <div class="chart-subtitle">MGC | RTH | 5m</div>
            <canvas id="barsChart"></canvas>
            <div class="custom-settings">
                <label>Touch Tolerance: <input type="number" id="touchTolerance" value="2.0" min="1" max="10"></label>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-title">VWAP Performance - by Performance</div>
            <div class="chart-subtitle">MGC | RTH | 5m</div>
            <canvas id="performanceChart"></canvas>
            <div class="custom-settings">
                <label>Time Window: <input type="number" id="timeWindow" value="5" min="5" max="30" step="5"> minutes</label>
            </div>
        </div>
    </div>

    <div class="date-range-info" id="dateRangeInfo">
        <div class="label">Report Timeframe</div>
        <div class="dates" id="dateRangeText">Loading...</div>
    </div>

    <div class="insights-table">
        <div class="insights-title">Insights</div>
        <table id="insightsTable">
            <thead>
                <tr>
                    <th>Cross Type</th>
                    <th>Total VWAP Touches</th>
                    <th>Avg Extension (ticks)</th>
                    <th>Max Extension (ticks)</th>
                    <th>Avg. Performance (ticks)</th>
                    <th>Max Performance (ticks)</th>
                </tr>
            </thead>
            <tbody id="insightsBody">
                <tr>
                    <td colspan="6" class="loading">Loading data...</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        // ALPHA DRIP Color Scheme
        const colors = {
            primary: '#00b4d8',
            secondary: '#0077b6',
            accent: '#90e0ef',
            purple: '#7b2cbf',
            lightPurple: '#9d4edd',
            success: '#4ade80',
            danger: '#f87171',
            dark: '#0a0e27',
            darker: '#0f1419'
        };

        // Chart configurations
        const chartOptions = {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom',
                    labels: {
                        color: '#90e0ef',
                        padding: 15,
                        font: {
                            size: 12
                        }
                    }
                },
                tooltip: {
                    backgroundColor: 'rgba(15, 20, 35, 0.95)',
                    titleColor: '#90e0ef',
                    bodyColor: '#ffffff',
                    borderColor: '#00b4d8',
                    borderWidth: 1,
                    padding: 12
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        color: '#90e0ef'
                    },
                    grid: {
                        color: 'rgba(0, 150, 255, 0.1)'
                    }
                },
                x: {
                    ticks: {
                        color: '#90e0ef'
                    },
                    grid: {
                        color: 'rgba(0, 150, 255, 0.1)'
                    }
                }
            }
        };

        let barsChart, performanceChart;

        // Embedded dashboard data
        const embeddedDashboardData = {
  "generated_at": "2026-01-17T11:32:12.552533",
  "date_range": {
    "start_date": "2024-05-29",
    "end_date": "2024-07-24",
    "total_sessions": 50
  },
  "upCross": {
    "total": 0,
    "avgTicks": 0,
    "maxTicks": 0,
    "avgPerformance": 0,
    "maxPerformance": 0
  },
  "downCross": {
    "total": 0,
    "avgTicks": 0,
    "maxTicks": 0,
    "avgPerformance": 0,
    "maxPerformance": 0
  },
  "event_type_filter": "CROSS"
};

        function loadData() {
            const data = embeddedDashboardData;
            
            const stats = {
                upCross: {
                    total: parseInt(data.upCross.total) || 0,
                    avgTicks: parseFloat(data.upCross.avgTicks || data.upCross.avgBars) || 0,
                    maxTicks: parseFloat(data.upCross.maxTicks || data.upCross.maxBars) || 0,
                    avgPerformance: parseFloat(data.upCross.avgPerformance) || 0,
                    maxPerformance: parseFloat(data.upCross.maxPerformance) || 0
                },
                downCross: {
                    total: parseInt(data.downCross.total) || 0,
                    avgTicks: parseFloat(data.downCross.avgTicks || data.downCross.avgBars) || 0,
                    maxTicks: parseFloat(data.downCross.maxTicks || data.downCross.maxBars) || 0,
                    avgPerformance: parseFloat(data.downCross.avgPerformance) || 0,
                    maxPerformance: parseFloat(data.downCross.maxPerformance) || 0
                }
            };
            
            updateCharts(stats);
            updateInsightsTable(stats);
            updateDateRange(data.date_range);
        }

        function updateCharts(stats) {
            // Bars Chart
            const barsCtx = document.getElementById('barsChart').getContext('2d');
            if (barsChart) barsChart.destroy();
            
            barsChart = new Chart(barsCtx, {
                type: 'bar',
                data: {
                    labels: ['Cross Up Max', 'Cross Up Avg Ticks', 'Cross Down Max', 'Cross Down Avg Ticks'],
                    datasets: [{
                        label: 'Extension (ticks)',
                        data: [
                            stats.upCross.maxTicks,
                            stats.upCross.avgTicks,
                            stats.downCross.maxTicks,
                            stats.downCross.avgTicks
                        ],
                        backgroundColor: [
                            colors.primary,
                            colors.secondary,
                            colors.accent,
                            colors.purple
                        ],
                        borderColor: [
                            colors.primary,
                            colors.secondary,
                            colors.accent,
                            colors.purple
                        ],
                        borderWidth: 2
                    }]
                },
                options: chartOptions
            });

            // Performance Chart
            const perfCtx = document.getElementById('performanceChart').getContext('2d');
            if (performanceChart) performanceChart.destroy();
            
            performanceChart = new Chart(perfCtx, {
                type: 'bar',
                data: {
                    labels: ['Cross Up Max', 'Cross Up Avg', 'Cross Down Max', 'Cross Down Avg'],
                    datasets: [{
                        label: 'Performance (ticks)',
                        data: [
                            stats.upCross.maxPerformance,
                            stats.upCross.avgPerformance,
                            stats.downCross.maxPerformance,
                            stats.downCross.avgPerformance
                        ],
                        backgroundColor: [
                            colors.primary,
                            colors.secondary,
                            colors.accent,
                            colors.purple
                        ],
                        borderColor: [
                            colors.primary,
                            colors.secondary,
                            colors.accent,
                            colors.purple
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    ...chartOptions,
                    scales: {
                        ...chartOptions.scales,
                        y: {
                            ...chartOptions.scales.y,
                            beginAtZero: false
                        }
                    }
                }
            });
        }

        function updateInsightsTable(stats) {
            const tbody = document.getElementById('insightsBody');
            tbody.innerHTML = `
                <tr>
                    <td><strong>Up Cross</strong></td>
                    <td>${stats.upCross.total}</td>
                    <td>${stats.upCross.avgTicks.toFixed(1)} ticks</td>
                    <td>${stats.upCross.maxTicks.toFixed(1)} ticks</td>
                    <td class="${stats.upCross.avgPerformance >= 0 ? 'positive' : 'negative'}">${stats.upCross.avgPerformance.toFixed(2)} ticks</td>
                    <td class="positive">${stats.upCross.maxPerformance.toFixed(2)} ticks</td>
                </tr>
                <tr>
                    <td><strong>Down Cross</strong></td>
                    <td>${stats.downCross.total}</td>
                    <td>${stats.downCross.avgTicks.toFixed(1)} ticks</td>
                    <td>${stats.downCross.maxTicks.toFixed(1)} ticks</td>
                    <td class="${stats.downCross.avgPerformance >= 0 ? 'positive' : 'negative'}">${stats.downCross.avgPerformance.toFixed(2)} ticks</td>
                    <td class="negative">${stats.downCross.maxPerformance.toFixed(2)} ticks</td>
                </tr>
            `;
        }

        function updateDateRange(dateRange) {
            const dateRangeText = document.getElementById('dateRangeText');
            if (dateRange && dateRange.start_date && dateRange.end_date) {
                // Parse date string (YYYY-MM-DD) and format without timezone conversion
                function formatDate(dateStr) {
                    const parts = dateStr.split('-');
                    if (parts.length === 3) {
                        const year = parts[0];
                        const month = parts[1];
                        const day = parts[2];
                        return `${month}/${day}/${year}`;
                    }
                    // Fallback to Date object if format is unexpected
                    return new Date(dateStr + 'T12:00:00').toLocaleDateString('en-US', { 
                        year: 'numeric', 
                        month: '2-digit', 
                        day: '2-digit' 
                    });
                }
                
                const startDate = formatDate(dateRange.start_date);
                const endDate = formatDate(dateRange.end_date);
                
                if (dateRange.start_date === dateRange.end_date) {
                    dateRangeText.textContent = `${startDate} (${dateRange.total_sessions} session${dateRange.total_sessions !== 1 ? 's' : ''})`;
                } else {
                    dateRangeText.textContent = `${startDate} - ${endDate} (${dateRange.total_sessions} sessions)`;
                }
            } else {
                dateRangeText.textContent = 'Date range not available';
            }
        }

        // Load data on page load
        loadData();
    </script>
</body>
</html>